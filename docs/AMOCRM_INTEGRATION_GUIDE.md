# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ AmoCRM: Digital Ecosystem 2026

–í–µ—Ä—Å–∏—è: 2.1 (–ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: 09.02.2026)

## üìñ –û–±–∑–æ—Ä
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π ¬´–†—É—Å–°—Ç–∞–Ω–∫–æ–°–±—ã—Ç¬ª –∏ AmoCRM –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–¥–∞–∂ –∏ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö:
1. **–°–∞–π—Ç/TMA ‚ûî AmoCRM**: –°–æ–∑–¥–∞–Ω–∏–µ —Å–¥–µ–ª–æ–∫ (leads) –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Å–µ—Ä–≤–∏—Å–∞ –∏–ª–∏ –ø–æ–∫—É–ø–∫–µ –∑–∞–ø—á–∞—Å—Ç–µ–π.
2. **AmoCRM ‚ûî TMA**: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –≤ ¬´–¶–∏—Ñ—Ä–æ–≤–æ–º –ü–∞—Å–ø–æ—Ä—Ç–µ¬ª –∫–ª–∏–µ–Ω—Ç–∞ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–¥–µ–ª–∫–∏.
3. **–î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∏ –¥–∞—Ç –¢–û.

---

## ‚úÖ –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (Production)

–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã ID –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—à–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω-—Å–µ—Ä–≤–µ—Ä–µ:

### 1. –í–æ—Ä–æ–Ω–∫–∏ –∏ —Å—Ç–∞—Ç—É—Å—ã
- **–û—Å–Ω–æ–≤–Ω–∞—è –≤–æ—Ä–æ–Ω–∫–∞**: ¬´–ö–ª–∏–µ–Ω—Ç—ã –û–û–û¬ª ‚Äî ID `10226282`
- **–ê–∫—Ç–∏–≤–Ω—ã–π —Å—Ç–∞—Ç—É—Å**: ¬´–ó–∞—è–≤–∫–∞¬ª ‚Äî ID `80953554`
- **–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä**: ID `12380450`

### 2. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **Redirect URL**: `https://api.td-rss.ru/webhook/amocrm` (–ö–†–ò–¢–ò–ß–ù–û –¥–ª—è OAuth2)
- **Subdomain**: `new599bd9d13818a` (–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–æ–¥–¥–æ–º–µ–Ω)
- **Integration ID (Client ID)**: `2df855f6-d54d-4c3c-bb8a-1d8ea8b3c1cd`

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª–µ–π
–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ ID –ø–æ–ª–µ–π –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–°–¥–µ–ª–∫–∏¬ª:
- **–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä**: ID `712629`
- **–ú–æ–¥–µ–ª—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è**: ID `712631`
- **Telegram ID**: ID `712633`

---

## üìã –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (Dokploy)
–î–ª—è —Ä–∞–±–æ—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö **Backend** —Å–µ—Ä–≤–∏—Å–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

### 1.1 –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (Long-lived Token)
–í —Ñ–µ–≤—Ä–∞–ª–µ 2026 –≥–æ–¥–∞ —Å–∏—Å—Ç–µ–º–∞ –±—ã–ª–∞ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–∞ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞**, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –¥–æ **09.02.2031**. 

*   **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –ò—Å–∫–ª—é—á–∞–µ—Ç —Ä–∏—Å–∫ ¬´–≤—ã–ª–µ—Ç–∞¬ª –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ —Å–±–æ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (refresh).
*   **–õ–æ–≥–∏–∫–∞**: –¢–æ–∫–µ–Ω –∂–µ—Å—Ç–∫–æ –ø—Ä–æ–ø–∏—Å–∞–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –µ–≥–æ –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —á–µ—Ä–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é, –Ω–æ –≤ —à—Ç–∞—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
*   **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —Å–ø–∏—Å–∫–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤ –±—ç–∫–µ–Ω–¥–∞.

> [!IMPORTANT]
> –ï—Å–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É 401, –≤–µ—Ä–æ—è—Ç–Ω–µ–µ –≤—Å–µ–≥–æ, `Refresh Token` —Å—Ç–∞–ª –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω. –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ `auth_code` –≤ –ø–∞–Ω–µ–ª–∏ AmoCRM.

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±—Ö—É–∫–æ–≤
–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö AmoCRM (–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º -> –í–µ–±—Ö—É–∫–∏) –¥–æ–±–∞–≤–ª–µ–Ω URL:
`https://api.td-rss.ru/webhook/amocrm`

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –¢–∏–ø–æ–≤—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:

1. **"Incorrect client"**: 
   - **–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ–ø—ã—Ç–∫–∞ –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω (refresh) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `Client ID` –∏–ª–∏ `Client Secret`, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç–µ–º, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –ø—Ä–∏ –≤—ã–¥–∞—á–µ —Ç–µ–∫—É—â–µ–≥–æ `Refresh Token`.
   - **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –≤ Dokploy. –ï—Å–ª–∏ –æ–Ω –º–µ–Ω—è–ª—Å—è ‚Äî –Ω—É–∂–Ω–æ –∑–∞–Ω–æ–≤–æ –ø–æ–ª—É—á–∏—Ç—å `auth_code`.

2. **"Cannot decrypt the authorization code"**:
   - **–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ `Redirect URI` –≤ –∫–æ–¥–µ –∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö AmoCRM.
   - **–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ AmoCRM –ø—Ä–æ–ø–∏—Å–∞–Ω–æ –∏–º–µ–Ω–Ω–æ `https://api.td-rss.ru/webhook/amocrm`.

3. **"401 Unauthorized"**:
   - **–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–π `Access Token`.
   - **–†–µ—à–µ–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –æ–±–Ω–æ–≤–∏—Ç—å –µ–≥–æ —Å–∞–º–∞. –ï—Å–ª–∏ –Ω–µ –º–æ–∂–µ—Ç ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ 1 –∏–ª–∏ 2.

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤—è–∑—å:
- **–¢–µ—Å—Ç–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç**: `GET https://api.td-rss.ru/ingest/test-crm`
  - *–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç*: `{"status":"success","amo_lead_id":...}`

---

## üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –∫–æ–¥–∞

- **leads.py**: –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π (—Å–∞–π—Ç, –±–æ—Ç, –∫–æ—Ä–∑–∏–Ω–∞). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `BackgroundTasks` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, —á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å UI.
- **amocrm.py**: –ö–ª–∏–µ–Ω—Ç –Ω–∞ –±–∞–∑–µ `aiohttp`. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç `Pipeline ID` –∏ `Status ID` –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω—ã —è–≤–Ω–æ.
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–æ—á—Ç–æ–π**: –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ª–∏–¥–∞ –≤—Å–µ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–æ–ø–∏—è –Ω–∞ `zakaz@tdrusstankosbyt.ru` —á–µ—Ä–µ–∑ `notification_service`.
