# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ AmoCRM: Digital Ecosystem 2026

–í–µ—Ä—Å–∏—è: 2.0 (–ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: 23.01.2026)

## üìñ –û–±–∑–æ—Ä
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π ¬´–†—É—Å–°—Ç–∞–Ω–∫–æ–°–±—ã—Ç¬ª –∏ AmoCRM –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–¥–∞–∂ –∏ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö:
1. **–°–∞–π—Ç/TMA ‚ûî AmoCRM**: –°–æ–∑–¥–∞–Ω–∏–µ —Å–¥–µ–ª–æ–∫ (leads) –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Å–µ—Ä–≤–∏—Å–∞ –∏–ª–∏ –ø–æ–∫—É–ø–∫–µ –∑–∞–ø—á–∞—Å—Ç–µ–π.
2. **AmoCRM ‚ûî TMA**: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –≤ ¬´–¶–∏—Ñ—Ä–æ–≤–æ–º –ü–∞—Å–ø–æ—Ä—Ç–µ¬ª –∫–ª–∏–µ–Ω—Ç–∞ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–¥–µ–ª–∫–∏.
3. **–î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∏ –¥–∞—Ç –¢–û.

---

## üõ† –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (Environment)
–î–ª—è —Ä–∞–±–æ—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ `apps/backend/.env` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
```env
AMOCRM_SUBDOMAIN=russtanko               # –í–∞—à –ø–æ–¥–¥–æ–º–µ–Ω –≤ AmoCRM
AMOCRM_ACCESS_TOKEN=xxx                  # Long-lived Access Token
AMOCRM_PIPELINE_ID=1234567               # ID –≤–æ—Ä–æ–Ω–∫–∏ –ø—Ä–æ–¥–∞–∂
AMOCRM_RESPONSIBLE_USER_ID=987654        # ID –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Custom Fields (–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è)
–í AmoCRM –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è –≤ –°–¥–µ–ª–∫–∞—Ö (Deals) –∏ –∑–∞–ø–∏—Å–∞—Ç—å –∏—Ö ID:
- **–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä**: –¢–µ–∫—Å—Ç (–ø—Ä–∏–≤—è–∑–∫–∞ –∫ `MachineInstance.serial_number`)
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –¢–µ–∫—Å—Ç/JSON (–ø—Ä–∏–≤—è–∑–∫–∞ –∫ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è)
- **–î–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¢–û**: –î–∞—Ç–∞ (–ø—Ä–∏–≤—è–∑–∫–∞ –∫ `next_maintenance_date`)

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Webhooks
–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö AmoCRM (–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º -> –í–µ–±—Ö—É–∫–∏) –¥–æ–±–∞–≤—å—Ç–µ URL:
`https://api.td-rss.ru/api/amocrm/webhook`

–°–æ–±—ã—Ç–∏—è –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏:
- [x] –°–¥–µ–ª–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∞ (—Å—Ç–∞—Ç—É—Å –ø–µ—Ä–µ–≤–µ–¥–µ–Ω –≤ ¬´–£—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ¬ª)
- [x] –ö–æ–Ω—Ç–∞–∫—Ç –∏–∑–º–µ–Ω–µ–Ω

---

## üîÑ –õ–æ–≥–∏–∫–∞ –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –û–±–º–µ–Ω–∞

### –ê. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
–ö–æ–≥–¥–∞ –º–µ–Ω–µ–¥–∂–µ—Ä –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —Å–¥–µ–ª–∫—É –≤ —ç—Ç–∞–ø **¬´–£—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ¬ª**:
1. AmoCRM –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–µ–±—Ö—É–∫ –≤ —Å–∏—Å—Ç–µ–º—É.
2. –°–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ –ò–ù–ù/–¢–µ–ª–µ—Ñ–æ–Ω—É.
3. –°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ `machine_instances`.
4. –ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram: *"–í–∞—à–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ!"*.
5. –í TMA –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ú–æ–π –ü–∞—Ä–∫¬ª –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–∞—Å–ø–æ—Ä—Ç.

### –ë. –°–µ—Ä–≤–∏—Å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
1. –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ë—ç–∫–µ–Ω–¥–∞ (`scheduler.py`) –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∞—Ç—ã –¢–û.
2. –ï—Å–ª–∏ –¥–æ –¢–û –æ—Å—Ç–∞–ª–æ—Å—å 30 –¥–Ω–µ–π, —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É.
3. **–í–∞–∂–Ω–æ**: –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ç–∞–∫–∂–µ —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É –∏–ª–∏ —Å–¥–µ–ª–∫—É –≤ AmoCRM –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞, —á—Ç–æ–±—ã –æ–Ω –ø—Ä–µ–¥–ª–æ–∂–∏–ª —Ä–∞—Å—Ö–æ–¥–Ω–∏–∫–∏ (¬´–î–æ–ø—Ä–æ–¥–∞–∂–∞¬ª).

### –í. –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø–æ —Å–µ—Ä–≤–∏—Å—É
1. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏ —á–µ—Ä–µ–∑ TMA –≤ AmoCRM —Å–æ–∑–¥–∞–µ—Ç—Å—è –°–¥–µ–ª–∫–∞.
2. –ï—Å–ª–∏ –∏–Ω–∂–µ–Ω–µ—Ä –Ω–∞ —Å–∞–π—Ç–µ –æ—Ç–º–µ—á–∞–µ—Ç —Ä–∞–±–æ—Ç—É –∫–∞–∫ ¬´–í—ã–ø–æ–ª–Ω–µ–Ω–æ¬ª, —Å—Ç–∞—Ç—É—Å —Å–¥–µ–ª–∫–∏ –≤ AmoCRM –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç –ë—ç–∫–µ–Ω–¥–∞).

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –û—Ç–ª–∞–¥–∫–∞
- **–õ–æ–≥–∏ –ë—ç–∫–µ–Ω–¥–∞**: `docker logs russtanko-backend | grep AmoCRM`
- **–¢–µ—Å—Ç–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç**: `POST /api/amocrm/webhook` (–º–æ–∂–Ω–æ —Å–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ AmoCRM).

---

## ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Long-lived —Ç–æ–∫–µ–Ω—ã AmoCRM.
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ IP-–∞–¥—Ä–µ—Å–∞ –≤—Ö–æ–¥—è—â–∏—Ö –≤–µ–±—Ö—É–∫–æ–≤ (AmoCRM –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–π–Ω–¥–∂–∏).
- –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ Client Secret –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –∫–æ–¥–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞.
